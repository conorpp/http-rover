<!DOCTYPE html>

<canvas id="videoCanvas" width="640" height="480">
    <p>
        Please use a browser that supports the Canvas Element, like
        <a href="http://www.google.com/chrome">Chrome</a>,
        <a href="http://www.mozilla.com/firefox/">Firefox</a>,
        <a href="http://www.apple.com/safari/">Safari</a> or Internet Explorer 10
    </p>
</canvas>

<button id="blink">Blink</button>

<script type="text/javascript">
    // Show loading notice
    var canvas = document.getElementById('videoCanvas');
    var ctx = canvas.getContext('2d');
    ctx.fillStyle = '#444';
    ctx.fillText('Loading...', canvas.width/2-30, canvas.height/3);

    // Setup the WebSocket connection and start the player
    var client = new WebSocket( 'ws://localhost:8084/' );
    var player = new jsmpeg(client, {canvas:canvas});

    var Command = {
        on:false,
        connect: function(){
            this.socket = io.connect(Settings.host, {port: Settings.command_port});
        },
        blink: function(){
            this.on = !this.on;
            this.socket.emit('blink', {on:this.on});
        }
    };
    Command.connect();
    
    Command.socket.on('blink', function(data){
        console.log('Blink command recieved: ', data['on']);
    });
    
    $('#blink').on('click', function(){
        Command.blink();
    })
</script>
